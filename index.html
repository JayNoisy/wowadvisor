<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WoW Talent Advisor</title>
  <meta name="wowadvisor-supabase-url" content="" />
  <meta name="wowadvisor-supabase-anon-key" content="" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' fill='%23171723'/%3E%3Ctext x='50%25' y='56%25' font-size='34' text-anchor='middle' fill='%23fff'%3E%E2%9A%94%3C/text%3E%3C/svg%3E" />

  <link rel="stylesheet" href="style.css?v=20260226-01" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="script.js?v=20260226-01" defer></script>
</head>
<body>
  <header class="header">
    <div class="header-auth-row">
      <p class="muted auth-status-text" id="authStatusText">Sign in to save copied builds and get outdated alerts.</p>
      <div class="auth-actions">
        <span id="authUserEmail" class="auth-user-email" hidden></span>
        <button id="authOpenBtn" class="auth-btn" type="button">Sign in</button>
        <button id="authLogoutBtn" class="auth-btn secondary" type="button" hidden>Sign out</button>
      </div>
    </div>
    <h1>WoW Talent Advisor</h1>
    <p>Select your class, then spec, then pick a build type.</p>
    <div id="buildFreshnessAlert" class="build-freshness-alert" hidden></div>
  </header>

  <main class="container">
    <section id="myBuildsCard" class="my-builds-card" hidden aria-label="My tracked builds">
      <div class="my-builds-head">
        <h2>My Builds</h2>
        <button id="myBuildsRefreshBtn" class="auth-btn secondary" type="button">Refresh</button>
      </div>
      <p id="myBuildsHint" class="muted">Sign in to track copied builds.</p>
      <div id="myBuildsList" class="my-builds-list"></div>
    </section>

    <section aria-label="Class selection">
      <div class="class-buttons" id="classButtons">
        <button class="class-btn" data-class="Warrior" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/warrior.png" alt="" /></span><span class="class-name">Warrior</span></button>
        <button class="class-btn" data-class="Paladin" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/paladin.png" alt="" /></span><span class="class-name">Paladin</span></button>
        <button class="class-btn" data-class="Hunter" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/hunter.png" alt="" /></span><span class="class-name">Hunter</span></button>
        <button class="class-btn" data-class="Rogue" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/rogue.png" alt="" /></span><span class="class-name">Rogue</span></button>
        <button class="class-btn" data-class="Priest" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/priest.png" alt="" /></span><span class="class-name">Priest</span></button>
        <button class="class-btn" data-class="Death Knight" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/death-knight.png" alt="" /></span><span class="class-name">Death Knight</span></button>
        <button class="class-btn" data-class="Shaman" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/shaman.png" alt="" /></span><span class="class-name">Shaman</span></button>
        <button class="class-btn" data-class="Mage" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/mage.png" alt="" /></span><span class="class-name">Mage</span></button>
        <button class="class-btn" data-class="Warlock" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/warlock.png" alt="" /></span><span class="class-name">Warlock</span></button>
        <button class="class-btn" data-class="Monk" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/monk.png" alt="" /></span><span class="class-name">Monk</span></button>
        <button class="class-btn" data-class="Druid" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/druid.png" alt="" /></span><span class="class-name">Druid</span></button>
        <button class="class-btn" data-class="Demon Hunter" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/demon-hunter.png" alt="" /></span><span class="class-name">Demon Hunter</span></button>
        <button class="class-btn" data-class="Evoker" aria-pressed="false"><span class="class-glyph" aria-hidden="true"><img class="class-icon-img" src="assets/class-icons/evoker.png" alt="" /></span><span class="class-name">Evoker</span></button>
      </div>
    </section>

    <section class="panel" id="panel" hidden aria-label="Spec selection and build">
      <div class="panel-header">
        <div class="panel-head-left">
          <div class="panel-title">
            <button id="backToClassesBtn" class="back-btn" type="button" aria-label="Back to class selection">Back</button>
            <h2 id="selectedClassTitle">Choose a class</h2>
          </div>
          <p class="muted" id="panelSubtitle">Then choose a spec.</p>
        </div>
        <span class="badge" id="classBadge" aria-hidden="true">?</span>
      </div>

      <div class="panel-body">
        <div class="specs">
          <h3 class="section-title">Specs</h3>
          <div class="spec-buttons" id="specButtons" aria-label="Spec selection"></div>
        </div>

        <div class="build-type" id="buildTypeWrap" hidden>
          <h3 class="section-title">Build type</h3>
          <div class="build-tabs" id="buildTabs" aria-label="Build type selection">
            <button class="tab-btn" data-mode="aoe" type="button">AoE (Mythic+)</button>
            <button class="tab-btn" data-mode="raid" type="button">Raid</button>
            <button class="tab-btn" data-mode="pvp" type="button">PvP</button>
          </div>
          <div class="mythic-context-card" id="mythicContextCard" hidden>
            <h4 class="mythic-context-title">Mythic+ Context</h4>
            <p class="muted" id="mythicContextHint">Set key level and affixes to tune AoE recommendations.</p>
            <div class="mythic-context-controls">
              <label class="mythic-level-label" for="mythicKeyLevel">Key level</label>
              <input id="mythicKeyLevel" class="mythic-level-input" type="number" min="2" max="35" step="1" value="10" />
              <button id="mythicQuickFortifiedBtn" class="mythic-quick-btn" type="button">Fortified week</button>
              <button id="mythicQuickTyrannicalBtn" class="mythic-quick-btn" type="button">Tyrannical week</button>
              <button id="mythicClearAffixesBtn" class="mythic-quick-btn" type="button">Clear affixes</button>
            </div>
            <div id="mythicAffixList" class="mythic-affix-list" aria-label="Affix selection"></div>
            <ul id="mythicContextNotes" class="notes" hidden></ul>
          </div>
          <button id="rotationToggleBtn" class="rotation-toggle-btn" type="button" hidden aria-expanded="false" aria-controls="rotationHelperPanel">Show Rotation Helper</button>
        </div>

        <div class="rotation-card" id="rotationHelperPanel" hidden>
          <h3 id="rotationTitle">Rotation Helper</h3>
          <p class="muted" id="rotationHint">Pick a spec to see rotation guidance.</p>
          <ol id="rotationSteps" class="rotation-steps"></ol>
        </div>

        <div class="build-card">
          <h3 id="buildTitle">Best Talent Build</h3>
          <p class="muted" id="buildMeta"></p>
          <p class="muted" id="buildHint">Pick a spec, then a build type.</p>

          <ul id="buildNotes" class="notes" hidden></ul>

          <div class="export-row">
            <input id="exportString" type="text" placeholder="Export string will appear hereâ€¦" readonly />
            <button id="copyBtn" type="button" disabled>Copy</button>
          </div>
        </div>

        <div class="stat-card" id="statCard">
          <h3>Stat Priorities</h3>
          <p class="muted" id="statHint">Pick a spec to view stat priorities.</p>
          <div id="statPills" class="stat-pills" hidden></div>
          <div id="statExplain" class="stat-explain" hidden></div>
        </div>

        <div class="talent-card" id="talentCard" hidden>
          <h3>Talent Tree (Blizzard API)</h3>
          <p class="muted" id="talentTreeHint" hidden>Pick a spec to load talent nodes.</p>
          <div id="talentTreeWrap" class="talent-tree-wrap" hidden>
            <div id="talent-system">
              <div class="talent-points-header">
                Points Spent: <span id="pointsSpent">0</span> / <span id="maxPoints">10</span>
              </div>

              <div class="talent-tree" id="talentTree"></div>
            </div>

            <div class="talent-tooltip" id="talentTooltip" style="display: none;"></div>
          </div>
          <div id="talentNodeInspector" class="talent-node-inspector" hidden>
            <h4 class="talent-node-title">Talent Details</h4>
            <p class="muted" id="talentNodeHint">Click a talent node to inspect it.</p>
            <div id="talentNodeBody" class="talent-node-body"></div>
          </div>
        </div>

      </div>
    </section>
  </main>

  <div id="authModal" class="auth-modal" hidden>
    <button class="auth-modal-backdrop" type="button" data-auth-close="true" aria-label="Close sign in"></button>
    <section class="auth-modal-card" role="dialog" aria-modal="true" aria-labelledby="authModalTitle">
      <div class="auth-modal-head">
        <h2 id="authModalTitle">Sign in</h2>
        <button id="authCloseBtn" type="button" class="auth-close-btn" aria-label="Close sign in">Close</button>
      </div>
      <p class="muted">Creating an account is optional. You can continue without signing in.</p>
      <label class="auth-label" for="authEmail">Email</label>
      <input id="authEmail" class="auth-input" type="email" autocomplete="email" placeholder="you@example.com" />
      <label class="auth-label" for="authPassword">Password</label>
      <input id="authPassword" class="auth-input" type="password" autocomplete="current-password" placeholder="At least 8 characters" />
      <div class="auth-modal-actions">
        <button id="authSignInBtn" class="auth-btn" type="button">Sign in</button>
        <button id="authSignUpBtn" class="auth-btn secondary" type="button">Create account</button>
      </div>
      <button id="authGoogleBtn" class="auth-btn google" type="button">Continue with Google</button>
      <button id="authGuestBtn" class="auth-btn ghost" type="button">Continue without account</button>
      <p id="authMessage" class="auth-message" hidden></p>
    </section>
  </div>
</body>
</html>
